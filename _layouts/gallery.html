---
layout: default
---

<div class="gallery">
  <h1>{{ page.title }}</h1>

  {% for painting in site.data.paintings %}
    <div class="painting">
      <h2>{{ painting.title }}</h2>
      <p>{{ painting.description }}</p>

      <!-- –ü—Ä–µ–≤—å—é -->
      <img src="{{ painting.images[0] }}" alt="–ü—Ä–µ–≤—å—é" class="preview-img" onclick="openModal('{{ painting.title }}', {{ forloop.index0 }})">
    </div>
  {% endfor %}
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <button class="prev" onclick="prevImage()">‚ùÆ</button>
    <img id="modal-img" src="" />
    <button class="next" onclick="nextImage()">‚ùØ</button>
    <div class="caption" id="modal-caption"></div>
    <div class="counter" id="modal-counter"></div>
  </div>
</div>

<style>
.modal {
  display: none;
  position: fixed;
  z-index: 999;
  padding-top: 60px;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.9);
}

.modal-content {
  margin: auto;
  display: block;
  max-width: 90%;
  max-height: 80vh;
  text-align: center;
  position: relative;
}

#modal-img {
  max-width: 100%;
  max-height: 70vh;
  border-radius: 8px;
}

.prev, .next {
  cursor: pointer;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 40px;
  color: white;
  background: rgba(0,0,0,0.5);
  border: none;
  padding: 10px;
  border-radius: 50%;
}

.prev { left: 20px; }
.next { right: 20px; }

.close {
  position: absolute;
  top: 20px;
  right: 45px;
  font-size: 40px;
  font-weight: bold;
  color: #fff;
  cursor: pointer;
}

.counter {
  color: white;
  margin-top: 10px;
}
</style>

<script>
// –ü–µ—Ä–µ–Ω–æ—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω –∏–∑ Jekyll –≤ JS
const paintings = [
  {% for painting in site.data.paintings %}
  {
    title: "{{ painting.title }}",
    images: [
      {% for image in painting.images %}
        "{{ image }}",
      {% endfor %}
    ]
  },
  {% endfor %}
];

let currentPaintingIndex = 0;
let currentImageIndex = 0;

// –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–≤–∞–π–ø–∞
let touchstartX = 0;
let touchendX = 0;

function openModal(title, index) {
  currentPaintingIndex = index;
  currentImageIndex = 0;
  const modal = document.getElementById("modal");
  const img = document.getElementById("modal-img");
  const caption = document.getElementById("modal-caption");
  const counter = document.getElementById("modal-counter");

  img.src = paintings[index].images[currentImageIndex];
  caption.innerText = title;
  updateCounter();

  // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∂–µ—Å—Ç–æ–≤
  const modalImg = document.getElementById("modal-img");
  modalImg.addEventListener('touchstart', handleTouchStart, false);
  modalImg.addEventListener('touchend', handleTouchEnd, false);

  modal.style.display = "block";
}

function closeModal() {
  document.getElementById("modal").style.display = "none";
}

function prevImage() {
  if (currentImageIndex > 0) {
    currentImageIndex--;
    document.getElementById("modal-img").src = paintings[currentPaintingIndex].images[currentImageIndex];
    updateCounter();
  }
}

function nextImage() {
  if (currentImageIndex < paintings[currentPaintingIndex].images.length - 1) {
    currentImageIndex++;
    document.getElementById("modal-img").src = paintings[currentPaintingIndex].images[currentImageIndex];
    updateCounter();
  }
}

function updateCounter() {
  document.getElementById("modal-counter").innerText =
    `${currentImageIndex + 1} –∏–∑ ${paintings[currentPaintingIndex].images.length}`;
}

// üñ±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–∞
function handleTouchStart(event) {
  touchstartX = event.changedTouches[0].screenX;
}

function handleTouchEnd(event) {
  touchendX = event.changedTouches[0].screenX;
  handleSwipe();
}

function handleSwipe() {
  const swipeThreshold = 30; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å–≤–∞–π–ø–∞
  const deltaX = touchendX - touchstartX;

  if (deltaX > swipeThreshold) {
    prevImage(); // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ ‚Üí –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Ñ–æ—Ç–æ
  }

  if (deltaX < -swipeThreshold) {
    nextImage(); // –°–≤–∞–π–ø –≤–ª–µ–≤–æ ‚Üí —Å–ª–µ–¥—É—é—â–µ–µ —Ñ–æ—Ç–æ
  }
}
</script>
